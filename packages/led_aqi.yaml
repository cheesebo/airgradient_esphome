interval:
  - interval: 1min
    # Set fifth, sixth and seventh LEDs to color based on AQI values and eighth one off
    then:
      - if:
          condition:
            light.is_on: led_strip
          then:
            - if:
                condition:
                  lambda: 'return id(pm_2_5_aqi).state < 4;'
                  #UK AQI: Low
                then:
                  - light.addressable_set: 
                      id: led_strip
                      range_from: 4
                      range_to: 6
                      #Green
                      red: 0%                                                     
                      green: 100%                                                   
                      blue: 0%
            - if:
                condition:
                  lambda: 'return id(pm_2_5_aqi).state = 5;'
                  #UK AQI: Still low
                then:
                  - light.addressable_set:             
                      id: led_strip                    
                      range_from: 4                    
                      range_to: 6
                      #Yellow               
                      red: 100%
                      green: 100%
                      blue: 0%
            - if:                                                                         
                condition:                                                                
                  lambda: 'return id(pm_2_5_aqi).state = 6;'  
                  #UK AQI: Moderate                                                       
                then:                                                                     
                  - light.addressable_set:                                                
                      id: led_strip                                                       
                      range_from: 4                                                       
                      range_to: 6                                                         
                      #Orange                                                             
                      red: 100%                                                           
                      green: 50%                                                          
                      blue: 0%     
            - if:
                condition:
                  lambda: 'return id(pm_2_5_aqi).state >= 7 && id(pm_2_5_aqi).state < 10;'
                  #UK AQI: High
                then:
                  - light.addressable_set:             
                      id: led_strip                    
                      range_from: 4                    
                      range_to: 6
                      #Red                      
                      red: 100%
                      green: 0%
                      blue: 0%
            - if:
                condition:
                  lambda: 'return id(pm_2_5_aqi).state >= 10;'
                  #UK AQI: Very High
                then:
                  - light.addressable_set:             
                      id: led_strip                    
                      range_from: 4                    
                      range_to: 6   
                      #Magenta                   
                      red: 100%
                      green: 0%
                      blue: 100%
            - light.addressable_set:
                id: led_strip
                range_from: 7                                                      
                range_to: 7                                                        
                red: 0%             
                green: 0%           
                blue: 0%  
